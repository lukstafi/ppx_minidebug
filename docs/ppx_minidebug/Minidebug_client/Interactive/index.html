<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Interactive (ppx_minidebug.Minidebug_client.Interactive)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 3.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../../../index.html">Index</a> &#x00BB; <a href="../../index.html">ppx_minidebug</a> &#x00BB; <a href="../index.html">Minidebug_client</a> &#x00BB; Interactive</nav><header class="odoc-preamble"><h1>Module <code><span>Minidebug_client.Interactive</span></code></h1><p>Shared types and utilities for both TUI and MCP frontends</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec value anchored" id="val-sanitize_text"><a href="#val-sanitize_text" class="anchor"></a><code><span><span class="keyword">val</span> sanitize_text : <span>string <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Sanitize text: replace control chars (newlines, tabs, etc.) with spaces.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Utf8"><a href="#module-Utf8" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Utf8/index.html">Utf8</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>UTF-8 aware string operations to avoid cutting multi-byte characters</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-search_results"><a href="#type-search_results" class="anchor"></a><code><span><span class="keyword">type</span> search_results</span><span> = <span><span>(int * int, bool)</span> <span class="xref-unresolved">Stdlib</span>.Hashtbl.t</span></span></code></div><div class="spec-doc"><p>Hash table of (scope_id, seq_id) pairs matching a search term. Value: true = actual search match, false = propagated ancestor highlight. This is shared memory written by background Domain, read by main TUI loop.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-search_type"><a href="#type-search_type" class="anchor"></a><code><span><span class="keyword">type</span> search_type</span><span> = </span></code><ol><li id="type-search_type.RegularSearch" class="def variant constructor anchored"><a href="#type-search_type.RegularSearch" class="anchor"></a><code><span>| </span><span><span class="constructor">RegularSearch</span> <span class="keyword">of</span> string</span></code></li><li id="type-search_type.ExtractSearch" class="def variant constructor anchored"><a href="#type-search_type.ExtractSearch" class="anchor"></a><code><span>| </span><span><span class="constructor">ExtractSearch</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-search_type.search_path" class="def record field anchored"><a href="#type-search_type.search_path" class="anchor"></a><code><span>search_path : <span>string list</span>;</span></code></li><li id="type-search_type.extraction_path" class="def record field anchored"><a href="#type-search_type.extraction_path" class="anchor"></a><code><span>extraction_path : <span>string list</span>;</span></code></li><li id="type-search_type.display_text" class="def record field anchored"><a href="#type-search_type.display_text" class="anchor"></a><code><span>display_text : string;</span></code></li></ol><code><span>}</span></code></li></ol></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-search_slot"><a href="#type-search_slot" class="anchor"></a><code><span><span class="keyword">type</span> search_slot</span><span> = </span><span>{</span></code><ol><li id="type-search_slot.search_type" class="def record field anchored"><a href="#type-search_slot.search_type" class="anchor"></a><code><span>search_type : <a href="#type-search_type">search_type</a>;</span></code></li><li id="type-search_slot.domain_handle" class="def record field anchored"><a href="#type-search_slot.domain_handle" class="anchor"></a><code><span>domain_handle : <span><span>unit <span class="xref-unresolved">Stdlib</span>.Domain.t</span> option</span>;</span></code></li><li id="type-search_slot.completed_ref" class="def record field anchored"><a href="#type-search_slot.completed_ref" class="anchor"></a><code><span>completed_ref : <span>bool <span class="xref-unresolved">Stdlib</span>.ref</span>;</span></code></li><li id="type-search_slot.results" class="def record field anchored"><a href="#type-search_slot.results" class="anchor"></a><code><span>results : <a href="#type-search_results">search_results</a>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-SlotNumber"><a href="#module-SlotNumber" class="anchor"></a><code><span><span class="keyword">module</span> <a href="SlotNumber/index.html">SlotNumber</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-SlotMap"><a href="#module-SlotMap" class="anchor"></a><code><span><span class="keyword">module</span> <a href="SlotMap/index.html">SlotMap</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-slot_map"><a href="#type-slot_map" class="anchor"></a><code><span><span class="keyword">type</span> slot_map</span><span> = <span><a href="#type-search_slot">search_slot</a> <a href="SlotMap/index.html#type-t">SlotMap.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-status_event"><a href="#type-status_event" class="anchor"></a><code><span><span class="keyword">type</span> status_event</span><span> = </span></code><ol><li id="type-status_event.SearchEvent" class="def variant constructor anchored"><a href="#type-status_event.SearchEvent" class="anchor"></a><code><span>| </span><span><span class="constructor">SearchEvent</span> <span class="keyword">of</span> <a href="SlotNumber/index.html#type-t">SlotNumber.t</a> * <a href="#type-search_type">search_type</a></span></code></li><li id="type-status_event.QuietPathEvent" class="def variant constructor anchored"><a href="#type-status_event.QuietPathEvent" class="anchor"></a><code><span>| </span><span><span class="constructor">QuietPathEvent</span> <span class="keyword">of</span> <span>string option</span></span></code></li></ol></div><div class="spec-doc"><p>Chronological event tracking for status line display. Captures the order in which searches and quiet path changes occur.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-status_history"><a href="#type-status_history" class="anchor"></a><code><span><span class="keyword">type</span> status_history</span><span> = <span><a href="#type-status_event">status_event</a> list</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_search_match"><a href="#val-get_search_match" class="anchor"></a><code><span><span class="keyword">val</span> get_search_match : 
  <span><span class="label">search_slots</span>:<span><a href="#type-search_slot">search_slot</a> <a href="SlotMap/index.html#type-t">SlotMap.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">scope_id</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">seq_id</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">current_slot</span>:<a href="SlotMap/index.html#type-key">SlotMap.key</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="SlotMap/index.html#type-key">SlotMap.key</a> option</span></span></code></div><div class="spec-doc"><p>Check if an entry matches any active search (returns slot number 1-4, or None). Checks slots in reverse chronological order to prioritize more recent searches. Slot ordering is determined by current_slot parameter.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_all_search_matches"><a href="#val-get_all_search_matches" class="anchor"></a><code><span><span class="keyword">val</span> get_all_search_matches : 
  <span><span class="label">search_slots</span>:<span><a href="#type-search_slot">search_slot</a> <a href="SlotMap/index.html#type-t">SlotMap.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">scope_id</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">seq_id</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><a href="SlotMap/index.html#type-key">SlotMap.key</a> list</span></span></code></div><div class="spec-doc"><p>Get all search slots that match an entry (for checkered pattern highlighting). Returns list of slot numbers in order S1, S2, S3, S4.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-find_next_search_result"><a href="#val-find_next_search_result" class="anchor"></a><code><span><span class="keyword">val</span> find_next_search_result : 
  <span><span class="label">search_slots</span>:<span><a href="#type-search_slot">search_slot</a> <a href="SlotMap/index.html#type-t">SlotMap.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">current_scope_id</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">current_seq_id</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">forward</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span>(int * int)</span> option</span></span></code></div><div class="spec-doc"><p>Find next/previous search result in hash tables (across all entries, not just visible). Returns (scope_id, seq_id) of the next match, or None if no more matches. Search direction: forward=true searches for matches with (scope_id, seq_id) &gt; current, forward=false searches for matches with (scope_id, seq_id) &lt; current Note: searches across all 4 search slots.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-EllipsisKey"><a href="#module-EllipsisKey" class="anchor"></a><code><span><span class="keyword">module</span> <a href="EllipsisKey/index.html">EllipsisKey</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Ellipsis key: (parent_scope_id, start_seq_id, end_seq_id)</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-EllipsisSet"><a href="#module-EllipsisSet" class="anchor"></a><code><span><span class="keyword">module</span> <a href="EllipsisSet/index.html">EllipsisSet</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-visible_item_content"><a href="#type-visible_item_content" class="anchor"></a><code><span><span class="keyword">type</span> visible_item_content</span><span> = </span></code><ol><li id="type-visible_item_content.RealEntry" class="def variant constructor anchored"><a href="#type-visible_item_content.RealEntry" class="anchor"></a><code><span>| </span><span><span class="constructor">RealEntry</span> <span class="keyword">of</span> <a href="../Query/index.html#type-entry">Query.entry</a></span></code></li><li id="type-visible_item_content.Ellipsis" class="def variant constructor anchored"><a href="#type-visible_item_content.Ellipsis" class="anchor"></a><code><span>| </span><span><span class="constructor">Ellipsis</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-visible_item_content.parent_scope_id" class="def record field anchored"><a href="#type-visible_item_content.parent_scope_id" class="anchor"></a><code><span>parent_scope_id : int;</span></code></li><li id="type-visible_item_content.start_seq_id" class="def record field anchored"><a href="#type-visible_item_content.start_seq_id" class="anchor"></a><code><span>start_seq_id : int;</span></code></li><li id="type-visible_item_content.end_seq_id" class="def record field anchored"><a href="#type-visible_item_content.end_seq_id" class="anchor"></a><code><span>end_seq_id : int;</span></code></li><li id="type-visible_item_content.hidden_count" class="def record field anchored"><a href="#type-visible_item_content.hidden_count" class="anchor"></a><code><span>hidden_count : int;</span></code></li></ol><code><span>}</span></code></li></ol></div><div class="spec-doc"><p>Content of a visible item - either a real entry or an ellipsis placeholder</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-view_state"><a href="#type-view_state" class="anchor"></a><code><span><span class="keyword">type</span> view_state</span><span> = </span><span>{</span></code><ol><li id="type-view_state.query" class="def record field anchored"><a href="#type-view_state.query" class="anchor"></a><code><span>query : <span>(<span class="keyword">module</span> <a href="../Query/module-type-S/index.html">Query.S</a>)</span>;</span></code></li><li id="type-view_state.db_path" class="def record field anchored"><a href="#type-view_state.db_path" class="anchor"></a><code><span>db_path : string;</span></code></li><li id="type-view_state.cursor" class="def record field anchored"><a href="#type-view_state.cursor" class="anchor"></a><code><span>cursor : int;</span></code></li><li id="type-view_state.scroll_offset" class="def record field anchored"><a href="#type-view_state.scroll_offset" class="anchor"></a><code><span>scroll_offset : int;</span></code></li><li id="type-view_state.expanded" class="def record field anchored"><a href="#type-view_state.expanded" class="anchor"></a><code><span>expanded : <span><span>(int, unit)</span> <span class="xref-unresolved">Stdlib</span>.Hashtbl.t</span>;</span></code></li><li id="type-view_state.visible_items" class="def record field anchored"><a href="#type-view_state.visible_items" class="anchor"></a><code><span>visible_items : <span><a href="#type-visible_item">visible_item</a> array</span>;</span></code></li><li id="type-view_state.show_times" class="def record field anchored"><a href="#type-view_state.show_times" class="anchor"></a><code><span>show_times : bool;</span></code></li><li id="type-view_state.values_first" class="def record field anchored"><a href="#type-view_state.values_first" class="anchor"></a><code><span>values_first : bool;</span></code></li><li id="type-view_state.max_scope_id" class="def record field anchored"><a href="#type-view_state.max_scope_id" class="anchor"></a><code><span>max_scope_id : int;</span></code></li><li id="type-view_state.search_slots" class="def record field anchored"><a href="#type-view_state.search_slots" class="anchor"></a><code><span>search_slots : <a href="#type-slot_map">slot_map</a>;</span></code></li><li id="type-view_state.current_slot" class="def record field anchored"><a href="#type-view_state.current_slot" class="anchor"></a><code><span>current_slot : <a href="SlotNumber/index.html#type-t">SlotNumber.t</a>;</span></code></li><li id="type-view_state.search_input" class="def record field anchored"><a href="#type-view_state.search_input" class="anchor"></a><code><span>search_input : <span>string option</span>;</span></code></li><li id="type-view_state.quiet_path_input" class="def record field anchored"><a href="#type-view_state.quiet_path_input" class="anchor"></a><code><span>quiet_path_input : <span>string option</span>;</span></code></li><li id="type-view_state.goto_input" class="def record field anchored"><a href="#type-view_state.goto_input" class="anchor"></a><code><span>goto_input : <span>string option</span>;</span></code></li><li id="type-view_state.quiet_path" class="def record field anchored"><a href="#type-view_state.quiet_path" class="anchor"></a><code><span>quiet_path : <span>string option</span>;</span></code></li><li id="type-view_state.search_order" class="def record field anchored"><a href="#type-view_state.search_order" class="anchor"></a><code><span>search_order : <a href="../Query/index.html#type-search_order">Query.search_order</a>;</span></code></li><li id="type-view_state.status_history" class="def record field anchored"><a href="#type-view_state.status_history" class="anchor"></a><code><span>status_history : <a href="#type-status_history">status_history</a>;</span></code></li><li id="type-view_state.unfolded_ellipsis" class="def record field anchored"><a href="#type-view_state.unfolded_ellipsis" class="anchor"></a><code><span>unfolded_ellipsis : <a href="EllipsisSet/index.html#type-t">EllipsisSet.t</a>;</span></code></li><li id="type-view_state.search_result_counts" class="def record field anchored"><a href="#type-view_state.search_result_counts" class="anchor"></a><code><span>search_result_counts : <span><span>(<a href="SlotNumber/index.html#type-t">SlotNumber.t</a>, int)</span> <span class="xref-unresolved">Stdlib</span>.Hashtbl.t</span>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-visible_item"><a href="#type-visible_item" class="anchor"></a><code><span><span class="keyword">and</span> visible_item</span><span> = </span><span>{</span></code><ol><li id="type-visible_item.content" class="def record field anchored"><a href="#type-visible_item.content" class="anchor"></a><code><span>content : <a href="#type-visible_item_content">visible_item_content</a>;</span></code></li><li id="type-visible_item.indent_level" class="def record field anchored"><a href="#type-visible_item.indent_level" class="anchor"></a><code><span>indent_level : int;</span></code></li><li id="type-visible_item.is_expandable" class="def record field anchored"><a href="#type-visible_item.is_expandable" class="anchor"></a><code><span>is_expandable : bool;</span></code></li><li id="type-visible_item.is_expanded" class="def record field anchored"><a href="#type-visible_item.is_expanded" class="anchor"></a><code><span>is_expanded : bool;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-command"><a href="#type-command" class="anchor"></a><code><span><span class="keyword">type</span> command</span><span> = </span></code><ol><li id="type-command.Navigate" class="def variant constructor anchored"><a href="#type-command.Navigate" class="anchor"></a><code><span>| </span><span><span class="constructor">Navigate</span> <span class="keyword">of</span> <span>[ `Up
            <span>| `Down</span>
            <span>| `PageUp</span>
            <span>| `PageDown</span>
            <span>| `QuarterUp</span>
            <span>| `QuarterDown</span>
            <span>| `Home</span>
            <span>| `End</span> ]</span></span></code></li><li id="type-command.ToggleExpansion" class="def variant constructor anchored"><a href="#type-command.ToggleExpansion" class="anchor"></a><code><span>| </span><span><span class="constructor">ToggleExpansion</span></span></code></li><li id="type-command.Fold" class="def variant constructor anchored"><a href="#type-command.Fold" class="anchor"></a><code><span>| </span><span><span class="constructor">Fold</span></span></code></li><li id="type-command.SearchNext" class="def variant constructor anchored"><a href="#type-command.SearchNext" class="anchor"></a><code><span>| </span><span><span class="constructor">SearchNext</span></span></code></li><li id="type-command.SearchPrev" class="def variant constructor anchored"><a href="#type-command.SearchPrev" class="anchor"></a><code><span>| </span><span><span class="constructor">SearchPrev</span></span></code></li><li id="type-command.GotoNextHighlight" class="def variant constructor anchored"><a href="#type-command.GotoNextHighlight" class="anchor"></a><code><span>| </span><span><span class="constructor">GotoNextHighlight</span></span></code></li><li id="type-command.GotoPrevHighlight" class="def variant constructor anchored"><a href="#type-command.GotoPrevHighlight" class="anchor"></a><code><span>| </span><span><span class="constructor">GotoPrevHighlight</span></span></code></li><li id="type-command.BeginSearch" class="def variant constructor anchored"><a href="#type-command.BeginSearch" class="anchor"></a><code><span>| </span><span><span class="constructor">BeginSearch</span> <span class="keyword">of</span> <span>string option</span></span></code></li><li id="type-command.BeginQuietPath" class="def variant constructor anchored"><a href="#type-command.BeginQuietPath" class="anchor"></a><code><span>| </span><span><span class="constructor">BeginQuietPath</span> <span class="keyword">of</span> <span>string option</span></span></code></li><li id="type-command.BeginGoto" class="def variant constructor anchored"><a href="#type-command.BeginGoto" class="anchor"></a><code><span>| </span><span><span class="constructor">BeginGoto</span> <span class="keyword">of</span> <span>int option</span></span></code></li><li id="type-command.ToggleTimes" class="def variant constructor anchored"><a href="#type-command.ToggleTimes" class="anchor"></a><code><span>| </span><span><span class="constructor">ToggleTimes</span></span></code></li><li id="type-command.ToggleValues" class="def variant constructor anchored"><a href="#type-command.ToggleValues" class="anchor"></a><code><span>| </span><span><span class="constructor">ToggleValues</span></span></code></li><li id="type-command.ToggleSearchOrder" class="def variant constructor anchored"><a href="#type-command.ToggleSearchOrder" class="anchor"></a><code><span>| </span><span><span class="constructor">ToggleSearchOrder</span></span></code></li><li id="type-command.Quit" class="def variant constructor anchored"><a href="#type-command.Quit" class="anchor"></a><code><span>| </span><span><span class="constructor">Quit</span></span></code></li><li id="type-command.InputChar" class="def variant constructor anchored"><a href="#type-command.InputChar" class="anchor"></a><code><span>| </span><span><span class="constructor">InputChar</span> <span class="keyword">of</span> char</span></code></li><li id="type-command.InputBackspace" class="def variant constructor anchored"><a href="#type-command.InputBackspace" class="anchor"></a><code><span>| </span><span><span class="constructor">InputBackspace</span></span></code></li><li id="type-command.InputEscape" class="def variant constructor anchored"><a href="#type-command.InputEscape" class="anchor"></a><code><span>| </span><span><span class="constructor">InputEscape</span></span></code></li><li id="type-command.InputEnter" class="def variant constructor anchored"><a href="#type-command.InputEnter" class="anchor"></a><code><span>| </span><span><span class="constructor">InputEnter</span></span></code></li></ol></div><div class="spec-doc"><p>Command type - abstracts keyboard events for both TUI and MCP</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-find_positive_ancestor_id"><a href="#val-find_positive_ancestor_id" class="anchor"></a><code><span><span class="keyword">val</span> find_positive_ancestor_id : <span><span>(<span class="keyword">module</span> <a href="../Query/module-type-S/index.html">Query.S</a>)</span> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span>int option</span></span></code></div><div class="spec-doc"><p>Find closest ancestor with positive ID by walking up the tree</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_entry_highlighted"><a href="#val-is_entry_highlighted" class="anchor"></a><code><span><span class="keyword">val</span> is_entry_highlighted : 
  <span><span class="label">search_slots</span>:<span><a href="#type-search_slot">search_slot</a> <a href="SlotMap/index.html#type-t">SlotMap.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">scope_id</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">seq_id</span>:int <span class="arrow">&#45;&gt;</span></span>
  bool</span></code></div><div class="spec-doc"><p>Check if an entry is highlighted in any search slot</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-compute_ellipsis_segments"><a href="#val-compute_ellipsis_segments" class="anchor"></a><code><span><span class="keyword">val</span> compute_ellipsis_segments : 
  <span><span class="label">parent_scope_id</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">children</span>:<span><a href="../Query/index.html#type-entry">Query.entry</a> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">search_slots</span>:<span><a href="#type-search_slot">search_slot</a> <a href="SlotMap/index.html#type-t">SlotMap.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">unfolded_ellipsis</span>:<a href="EllipsisSet/index.html#type-t">EllipsisSet.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>[&gt; <span>`Ellipsis of int * int * int * int</span> <span><span>| `Entry</span> of <a href="../Query/index.html#type-entry">Query.entry</a></span> ]</span> list</span></span></code></div><div class="spec-doc"><p>Compute ellipsis segments for a list of child entries. Returns a list mixing real entries and ellipsis placeholders.</p><p>Algorithm: 1. Treat first and last child as &quot;always highlighted&quot; for context 2. Identify which entries are highlighted (from search matches) 3. Find contiguous non-highlighted sections between highlighted siblings 4. If section has &gt;3 entries AND not manually unfolded → create ellipsis 5. Otherwise include all entries in that section</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-build_visible_items"><a href="#val-build_visible_items" class="anchor"></a><code><span><span class="keyword">val</span> build_visible_items : 
  <span><span>(<span class="keyword">module</span> <a href="../Query/module-type-S/index.html">Query.S</a>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>(int, <span class="type-var">'a</span>)</span> <span class="xref-unresolved">Stdlib</span>.Hashtbl.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span>bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">search_slots</span>:<span><a href="#type-search_slot">search_slot</a> <a href="SlotMap/index.html#type-t">SlotMap.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">current_slot</span>:<a href="SlotMap/index.html#type-key">SlotMap.key</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">unfolded_ellipsis</span>:<a href="EllipsisSet/index.html#type-t">EllipsisSet.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-visible_item">visible_item</a> array</span></span></code></div><div class="spec-doc"><p>Build visible items list from database using lazy loading</p></div></div><div class="odoc-spec"><div class="spec module-type anchored" id="module-type-TUI_CORE"><a href="#module-type-TUI_CORE" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-TUI_CORE/index.html">TUI_CORE</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>MCP-compatible TUI core - uses TextRenderer</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-toggle_expansion"><a href="#val-toggle_expansion" class="anchor"></a><code><span><span class="keyword">val</span> toggle_expansion : <span><a href="#type-view_state">view_state</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-view_state">view_state</a></span></code></div><div class="spec-doc"><p>Toggle expansion of current item (or unfold ellipsis)</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-fold_selection"><a href="#val-fold_selection" class="anchor"></a><code><span><span class="keyword">val</span> fold_selection : <span><a href="#type-view_state">view_state</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-view_state">view_state</a></span></code></div><div class="spec-doc"><p>Fold current selection: re-fold an unfolded ellipsis if possible, otherwise fold parent scope. After folding, position cursor on the ellipsis or scope header entry.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-find_and_jump_to_search_result"><a href="#val-find_and_jump_to_search_result" class="anchor"></a><code><span><span class="keyword">val</span> find_and_jump_to_search_result : 
  <span><a href="#type-view_state">view_state</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">forward</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">height</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-view_state">view_state</a> option</span></span></code></div><div class="spec-doc"><p>Find next/previous search result (searches hash tables, not just visible items). Returns updated state with cursor moved to the match and path auto-expanded, or None if no match.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-goto_scope"><a href="#val-goto_scope" class="anchor"></a><code><span><span class="keyword">val</span> goto_scope : <span><a href="#type-view_state">view_state</a> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span><span class="label">height</span>:int <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-view_state">view_state</a> option</span></span></code></div><div class="spec-doc"><p>Jump to scope with given ID (find header entry with child_scope_id = target_id). Returns updated state with cursor positioned at scope header if visible, or at the closest visible ancestor (which may be an ellipsis containing it). Does not unfold.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_item_highlighted"><a href="#val-is_item_highlighted" class="anchor"></a><code><span><span class="keyword">val</span> is_item_highlighted : 
  <span><span class="label">search_slots</span>:<span><a href="#type-search_slot">search_slot</a> <a href="SlotMap/index.html#type-t">SlotMap.t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-visible_item">visible_item</a> <span class="arrow">&#45;&gt;</span></span>
  bool</span></code></div><div class="spec-doc"><p>Check if a visible_item is highlighted in any search slot</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-goto_highlight_and_expand"><a href="#val-goto_highlight_and_expand" class="anchor"></a><code><span><span class="keyword">val</span> goto_highlight_and_expand : 
  <span><a href="#type-view_state">view_state</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">forward</span>:bool <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">height</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-view_state">view_state</a> option</span></span></code></div><div class="spec-doc"><p>Go to next/previous highlight and expand. Searches through potentially visible items, expands highlighted scopes, and searches within for nested highlights. Returns updated state with cursor at highlight, or None if no highlight found.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-handle_command"><a href="#val-handle_command" class="anchor"></a><code><span><span class="keyword">val</span> handle_command : <span><a href="#type-view_state">view_state</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-command">command</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="label">height</span>:int <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-view_state">view_state</a> option</span></span></code></div><div class="spec-doc"><p>Handle commands - core command processing logic</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-initial_state"><a href="#val-initial_state" class="anchor"></a><code><span><span class="keyword">val</span> initial_state : <span><span>(<span class="keyword">module</span> <a href="../Query/module-type-S/index.html">Query.S</a>)</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-view_state">view_state</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-run"><a href="#val-run" class="anchor"></a><code><span><span class="keyword">val</span> run : 
  <span><span>(<span class="keyword">module</span> <a href="../Query/module-type-S/index.html">Query.S</a>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">initial_state</span>:<a href="#type-view_state">view_state</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">command_stream</span>:<span>(<span><a href="#type-view_state">view_state</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-command">command</a> option</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">render_screen</span>:<span>(<span><a href="#type-view_state">view_state</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="label">width</span>:<span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="label">height</span>:int <span class="arrow">&#45;&gt;</span></span> unit)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">output_size</span>:<span>(<span>unit <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span> * int)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">finalize</span>:<span>(<span>unit <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span class="type-var">'b</span></span></code></div><div class="spec-doc"><p>Main interactive loop</p></div></div></div></body></html>
